<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Clinical Evidence Navigator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { font-family: system-ui, sans-serif; margin: 24px; }
      .box { border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; }
      .row { display: flex; gap: 8px; margin-top: 12px; }
      input, button { padding: 10px; }
      input { flex: 1; border: 1px solid #cbd5e1; border-radius: 6px; }
      button { border: 1px solid #cbd5e1; background: #f8fafc; border-radius: 6px; }
      .msg { white-space: pre-wrap; margin: 12px 0; }
    </style>
.chat-area { max-height: 70vh; overflow-y: auto; }
.msg.user { color: #1e3a8a; }
.msg.assistant { color: #334155; }

  </head>
  <body>
    <body style="padding: 24px;">
    <h1>Clinical Evidence Navigator</h1>
    <p style="color:#555">Ask for evidence. For education onlyâ€”no medical advice.</p>

    <div id="chat" class="box chat-area"></div>
      <p id="empty">Type a question below to begin.</p>
    </div>

<div style="margin: 12px 0; font-size: 14px;">
  <strong>Try one:</strong>
  <button onclick="preset('Summarize RCTs of semaglutide in NASH')">Semaglutide</button>
  <button onclick="preset('Build a PubMed query for SGLT2 in heart failure')">SGLT2 in HF</button>
  <button onclick="preset('List phase 3 trials of tirzepatide in obesity')">Tirzepatide</button>
</div>
<script>
  function preset(text){
    document.getElementById('input').value = text;
  }
</script>

    
    <div class="row">
      <input id="input" placeholder="e.g., Summarize RCTs of semaglutide in NASH" />
      <button id="send">Send</button>
    </div>

    <script>
      const chat = document.getElementById("chat");
      const input = document.getElementById("input");
      const sendBtn = document.getElementById("send");
      const messages = [];

      function add(role, content) {
        document.getElementById("empty")?.remove();
        const div = document.createElement("div");
        div.className = "msg " + (role === "user" ? "user" : "assistant");
        div.innerHTML = `<strong>${role === "user" ? "You" : "Navigator"}:</strong> ${content}`;

        chat.appendChild(div);
        window.scrollTo(0, document.body.scrollHeight);
      }

      async function send() {
        const content = input.value.trim();
        if (!content) return;
        input.value = "";
        messages.push({ role: "user", content });
        add("user", content);

        const res = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ messages }),
        });
        const text = await res.text();
        messages.push({ role: "assistant", content: text });
        add("assistant", text);
      }

      sendBtn.addEventListener("click", send);
      input.addEventListener("keydown", (e) => { if (e.key === "Enter") send(); });
    </script>
  </body>
</html>
